<!doctype html> <html class="no-js" lang="en-US"> <head><meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Haruka Teardown • Benji</title><meta name="viewport" content="width=device-width"> <meta name="theme-color" content="#673ab7"> <link rel="shortcut icon" href="/assets/favicon/144.png"> <meta name="og:title" content="Haruka Teardown"> <meta name="og:url" content="https://benjic.xyz/2018-07-30/haruka-teardown/"> <meta name="og:description" content="A somewhat comprehensive teardown on how Haruka works."> <meta name="description" content="A somewhat comprehensive teardown on how Haruka works."> <meta name="og:type" content="website"> <meta name="twitter:title" content="Haruka Teardown"> <meta name="twitter:description" content="A somewhat comprehensive teardown on how Haruka works."> <meta name="og:image" content="https://benjic.xyz/assets/Haruka-minun.webp"> <meta name="og:image:alt" content="A screenshot of a Discord chat."> <meta name="twitter:image" content="https://benjic.xyz/assets/Haruka-minun.webp"> <meta name="twitter:image:alt" content="A screenshot of a Discord chat."> <meta name="twitter:site" content="@MindfulMinun"> <meta name="twitter:creator" content="@MindfulMinun"> <meta name="article:published_time" content="2018-07-30T23:36:57-05:00"> <meta name="twitter:widgets:theme" content="dark"> <meta name="twitter:widgets:link-color" content="#673ab7"> <meta name="twitter:widgets:border-color" content="#673ab7"> <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Material+Icons|Roboto:100,100i,200,200i,300,300i,400,400i,500,500i|Roboto+Mono:300,300i,400,400i"> <meta name="google-site-verification" content="3RNRM0WftJT1LuEg3jjTpufm1mxfhkHNtRJFMBP1Eyc"> <script async src="https://www.google-analytics.com/analytics.js"></script> <script src="/scripts/focus-visible.js" async></script> <script src="https://twemoji.maxcdn.com/2/twemoji.min.js?2.6"></script> <script type="text/javascript">!function(e,t){"use strict";e.documentElement.classList.remove("no-js"),window.ga=function(){ga.q.push(arguments)},ga.q=[],ga.l=+new Date,ga("create","UA-113187497-1","auto"),ga("send","pageview",location.pathname),t.xyz=t.xyz||{ready:function(t){(e.attachEvent?"complete"===e.readyState:"loading"!==e.readyState)?t():e.addEventListener("DOMContentLoaded",t)}},t.twemoji=t.twemoji||{parse:function(e){return e}},twemoji.size="svg",twemoji.ext=".svg",t.onerror=function(e,n,o,a){var i=n+" @ "+o+":"+a+":\n\t"+e;return"ga"in t&&!i.includes("Ahaha!")&&ga("send","event","Client error",i),xyz.toast({content:"An uncaught exception has occurred, see the console for more details.",timeout:5e3}),console.warn("%cException:","font-weight:bold",i),!1}}(document,window);</script> <meta name="post:title" content="Haruka Teardown"> <meta name="post:share-text" content="How Haruka works."> <meta name="post:permalink" content="https://benjic.xyz/2018-07-30/haruka-teardown/"> <link rel="stylesheet" href="/styles/master.css"> <link rel="stylesheet" href="/styles/post.css"></head> <body class="fluid-body post"><!--[if lte IE 9]><div class="banner error"><div class="container"><p class="browserupgrade banner--content"> <strong>Outdated browser:</strong> What’s an emo’s favorite browser? Edge. Speaking of browsers, please upgrade / replace yours. The Internet won’t stop nagging about it until you do. </p></div></div><![endif]--> <noscript class="banner error"><div class="container"><p class="banner--content"><strong>JavaScript Disabled:</strong> stop being so paranoid and enable js </p></div> </noscript><script>xyz.banner={close:function(e,n){var a=document.querySelector('.banner[data-banner-id="'+e+'"]');if(!n){var r=JSON.parse(localStorage.getItem("xyz::banner"))||{};r[e]=!0,localStorage.setItem("xyz::banner",JSON.stringify(r))}a.classList.add("banner-hidden")},init:function(){for(var e=document.querySelectorAll(".banner[data-banner-id]"),n=JSON.parse(localStorage.getItem("xyz::banner"))||{},a=0;a<e.length;a++){n[e[a].dataset.bannerId]&&(e[a].style.display="none")}}},xyz.banner.init();</script> <main><header class="post-metadata cf ribbon-image" style="background-image: url(https://benjic.xyz/assets/Haruka-minun.webp); background-color: #36393f"><div class="ribbon-gradient-container"> <div class="container flex end"> <h1 class="flex-fill-row" style="margin-bottom: 0;">Haruka Teardown</h1> <p class="flex-fill-space"> Written on <time datetime="2018-07-30T23:36:57-05:00" class="i18n"> Mon, Jul 30, 11:36 pm CDT </time> </p> <button class="flat-btn icon-btn no-js-hide print-hide" id="share" aria-label="Share this post"> <i class="material-icons">share</i> </button> </div> </div> </header> <hr class="print-only"> <div class="container"> <article class="post-content"> <p>This is a somewhat~ comprehensive guide on how Haruka works.</p> <ul> <li><a href="https://github.com/MindfulMinun/discord-haruka" title="MindfulMinun/discord-haruka: Haruka, a useless Discord bot.">GitHub Repository</a></li> <li><a href="https://discordapp.com/oauth2/authorize?client_id=458130019554820127&amp;scope=bot&amp;permissions=125966">Add Haruka</a> to your Discord server.</li> </ul> <p>There’s three main parts to Haruka:</p> <ol> <li>Setup: <code class="highlighter-rouge">main.coffee</code> <ul> <li>Connects to Discord and listens for messages.</li> </ul> </li> <li>Haruka: <code class="highlighter-rouge">Haruka.coffee</code> <ul> <li>Collects all Functions and determines which one should be run.</li> </ul> </li> <li>Functions <ul> <li>Haruka’s high-level methods.</li> </ul> </li> <li>The Haruka object <ul> <li>The whole environment revolves around the Haruka object.</li> </ul> </li> </ol> <hr/> <h2 id="setup">Setup</h2> <p>The Setup script (<code class="highlighter-rouge">main.coffee</code>) is Haruka’s entry point. To run Haruka, execute this script via <code class="highlighter-rouge">node dist/main.js</code> or <code class="highlighter-rouge">coffee src/main.coffee</code>. This script is responsible for connecting Haruka to Discord. Although it’s called <code class="highlighter-rouge">main.coffee</code>, not much happens in this script. The most important parts are as follows:</p> <div class="language-coffee highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Haruka</span> <span class="o">=</span> <span class="nx">require</span> <span class="s">'./Haruka.js'</span>
<span class="nx">config</span> <span class="o">=</span> <span class="nx">require</span> <span class="s">'../config.json'</span>
<span class="nx">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Discord</span><span class="p">.</span><span class="na">Client</span>
<span class="nx">client</span><span class="p">.</span><span class="na">on</span> <span class="s">'message'</span><span class="p">,</span> <span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="nx">Haruka</span><span class="p">.</span><span class="na">try</span> <span class="nx">msg</span>

<span class="nx">client</span><span class="p">.</span><span class="na">login</span> <span class="nx">config</span><span class="p">.</span><span class="na">token</span>
</code></pre></div></div> <p>The script adds a couple of event listeners, and when a message is received, it is passed to the <code class="highlighter-rouge">Haruka.try</code> function.</p> <hr/> <h2 id="haruka">Haruka</h2> <p>The core of Haruka is in the <code class="highlighter-rouge">Haruka.coffee</code> script. This script is responsible for:</p> <ol> <li>Collecting all the functions and specials that can be executed.</li> <li>Executing functions and specials and sending an appropriate response.</li> </ol> <h3 id="collecting-functions-and-specials">Collecting functions and specials</h3> <p>The first part of the <code class="highlighter-rouge">Haruka.coffee</code> script looks in the <code class="highlighter-rouge">/functions</code> and <code class="highlighter-rouge">/specials</code> folders for functions and specials. Then, these functions are added to arrays for later.</p> <div class="language-coffee highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Haruka</span> <span class="o">=</span> <span class="p">{}</span>
<span class="nx">Haruka</span><span class="p">.</span><span class="na">functions</span> <span class="o">=</span> <span class="p">[]</span>
<span class="nx">Haruka</span><span class="p">.</span><span class="na">specials</span>  <span class="o">=</span> <span class="p">[]</span>

<span class="c1">#! ========================================</span>
<span class="c1">#! Take Haruka's functions and add them to the queue</span>
<span class="nx">fs</span><span class="p">.</span><span class="na">readdirSync</span> <span class="s">"</span><span class="si">#{</span><span class="nx">__dirname</span><span class="si">}</span><span class="s">/functions"</span>
    <span class="p">.</span><span class="na">filter</span> <span class="p">(</span><span class="nx">filename</span><span class="p">)</span> <span class="o">-&gt;</span>
        <span class="sr">/^(?:[^_]).+(?:\.(?:coffee|js))/</span><span class="p">.</span><span class="na">test</span> <span class="nx">filename</span>
    <span class="p">.</span><span class="na">forEach</span> <span class="p">(</span><span class="nx">filename</span><span class="p">)</span> <span class="o">-&gt;</span>
        <span class="nx">Haruka</span><span class="p">.</span><span class="na">functions</span><span class="p">.</span><span class="na">push</span><span class="p">(</span>
            <span class="nx">require</span> <span class="s">"</span><span class="si">#{</span><span class="nx">__dirname</span><span class="si">}</span><span class="s">/functions/</span><span class="si">#{</span><span class="nx">filename</span><span class="si">}</span><span class="s">"</span>
        <span class="p">)</span>

<span class="c1">#! ========================================</span>
<span class="c1">#! Likewise, take Haruka's special functions and add them to the other queue</span>
<span class="nx">fs</span><span class="p">.</span><span class="na">readdirSync</span> <span class="s">"</span><span class="si">#{</span><span class="nx">__dirname</span><span class="si">}</span><span class="s">/specials"</span>
    <span class="p">.</span><span class="na">filter</span> <span class="p">(</span><span class="nx">filename</span><span class="p">)</span> <span class="o">-&gt;</span>
        <span class="sr">/^(?:[^_]).+(?:\.(?:coffee|js))/</span><span class="p">.</span><span class="na">test</span> <span class="nx">filename</span>
    <span class="p">.</span><span class="na">forEach</span> <span class="p">(</span><span class="nx">filename</span><span class="p">)</span> <span class="o">-&gt;</span>
        <span class="nx">Haruka</span><span class="p">.</span><span class="na">functions</span><span class="p">.</span><span class="na">push</span><span class="p">(</span>
            <span class="nx">require</span> <span class="s">"</span><span class="si">#{</span><span class="nx">__dirname</span><span class="si">}</span><span class="s">/specials/</span><span class="si">#{</span><span class="nx">filename</span><span class="si">}</span><span class="s">"</span>
        <span class="p">)</span>
</code></pre></div></div> <p>A function is only added if it’s a script (obviously) and if it doesn’t start with an underscore. If you wish to exclude a function from Haruka, rename that script so that it begins with an underscore.</p> <h3 id="executing-functions-and-specials">Executing functions and specials</h3> <p>The heart of Haruka lies in the <code class="highlighter-rouge">Haruka.try</code> method. Here’s the function, in plain English.</p> <ul> <li>Run all specials. <ul> <li>If the special handles the message, it should return a truthy value.</li> <li>If the special doesn’t handle the message, it should return a false-y value.</li> </ul> </li> <li><code class="highlighter-rouge">Haruka.try</code> will end early if a Special returns a truthy value.</li> <li><code class="highlighter-rouge">Haruka.try</code> will end early if the message doesn’t start with the prefix (<code class="highlighter-rouge">-h</code>) or if the message was sent by a bot.</li> <li>Execute all of the Function’s RegExp’s against the message content, excluding the prefix. <ul> <li>If there’s a match, run that function.</li> </ul> </li> <li>If there are no RegExp matches, Haruka replies saying that she didn’t recognize that command.</li> </ul> <div class="language-coffee highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Haruka</span><span class="p">.</span><span class="na">try</span> <span class="o">=</span> <span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="c1">#! Run Specials first</span>
    <span class="k">for</span> <span class="nx">fn</span> <span class="k">in</span> <span class="nx">Haruka</span><span class="p">.</span><span class="na">specials</span>
        <span class="c1">#! Break if handler returns a truthy value.</span>
        <span class="k">if</span> <span class="nx">fn</span><span class="p">.</span><span class="na">handler</span><span class="p">(</span><span class="nx">msg</span><span class="p">,</span> <span class="nx">Haruka</span><span class="p">)</span> <span class="k">then</span> <span class="k">return</span>

    <span class="c1">#! Tokenize input</span>
    <span class="nx">txt</span> <span class="o">=</span> <span class="nx">msg</span><span class="p">.</span><span class="na">content</span><span class="p">.</span><span class="na">tokenize</span><span class="p">()</span>
    <span class="nx">txt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="k">if</span> <span class="nx">txt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">then</span> <span class="nx">txt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="s">"help"</span>

    <span class="c1">#! Check if the message starts with the prefix,</span>
    <span class="c1">#! and it's not from another bot.</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">txt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">isnt</span> <span class="nx">Haruka</span><span class="p">.</span><span class="na">prefix</span><span class="p">)</span> <span class="o">or</span> <span class="nx">msg</span><span class="p">.</span><span class="na">author</span><span class="p">.</span><span class="na">bot</span> <span class="k">then</span> <span class="k">return</span>

    <span class="c1">#! Run through all the commands and see if one matches.</span>
    <span class="k">for</span> <span class="nx">fn</span> <span class="k">in</span> <span class="nx">Haruka</span><span class="p">.</span><span class="na">functions</span>
        <span class="nx">regexMatch</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">.</span><span class="na">regex</span><span class="p">.</span><span class="na">exec</span> <span class="nx">txt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="nx">regexMatch</span>
            <span class="k">return</span> <span class="nx">fn</span><span class="p">.</span><span class="na">handler</span><span class="p">(</span><span class="nx">msg</span><span class="p">,</span> <span class="nx">regexMatch</span><span class="p">,</span> <span class="nx">Haruka</span><span class="p">)</span>

    <span class="c1">#! Catchall</span>
    <span class="k">return</span> <span class="nx">msg</span><span class="p">.</span><span class="na">reply</span> <span class="p">[</span>
        <span class="s">"Hmm, I'm not sure what you mean by that."</span>
        <span class="s">"Sorry, I don't know what you meant by that."</span>
        <span class="s">"I’m not sure I understand."</span>
        <span class="s">"I’m not sure what you mean."</span>
    <span class="p">].</span><span class="na">choose</span><span class="p">()</span> <span class="o">+</span> <span class="s">" Try `-h help` for a list of commands."</span>
</code></pre></div></div> <hr/> <h2 id="functions-and-specials">Functions and Specials</h2> <p>Functions and specials take on very similar formats. Both are exported via <code class="highlighter-rouge">module.exports</code>, and both share a couple of the same attributes, but there are important distinctions to be made. Here’s the simplest example of an exported function object:</p> <div class="language-coffee highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Function object</span>
<span class="nx">module</span><span class="p">.</span><span class="na">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">name</span><span class="o">:</span> <span class="s">"Function name"</span>
    <span class="na">regex</span><span class="o">:</span> <span class="sr">/^(fn|function)(\s+|$)/i</span>
    <span class="na">handler</span><span class="o">:</span> <span class="p">(</span><span class="nx">msg</span><span class="p">,</span> <span class="nx">regexMatch</span><span class="p">,</span> <span class="nx">Haruka</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nx">msg</span><span class="p">.</span><span class="na">reply</span> <span class="s">"Hello world!"</span>
    <span class="na">help</span><span class="o">:</span>
        <span class="na">short</span><span class="o">:</span> <span class="s">"-h fn          :: Short function description."</span>
        <span class="na">long</span><span class="o">:</span> <span class="s">"""
            </span><span class="se">\`\`\`</span><span class="s">asciidoc
            === Help for Function ===
            *Aliases*: list, of, aliases
            -h fn       :: Function without arguments.
            -h fn &lt;arg&gt; :: Function with arguments.
            </span><span class="se">\`\`\`</span><span class="s">
        """</span>
<span class="p">}</span>
</code></pre></div></div> <ul> <li><code class="highlighter-rouge">name</code> <ul> <li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="String - JavaScript | MDN"><em>String:</em></a> The name of the function. Pretty self explanatory.</li> </ul> </li> <li><code class="highlighter-rouge">regex</code> <ul> <li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp" title="RegExp - JavaScript | MDN"><em>RegExp:</em></a> The function’s Regular Expression. This RegExp is tested against message input <strong>without the Haruka prefix.</strong> If there’s a match, <code class="highlighter-rouge">handler</code> is called.</li> </ul> </li> <li><code class="highlighter-rouge">handler</code> <ul> <li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" title="Function - JavaScript | MDN"><em>Function:</em></a> The function’s … message handler. Here’s where all of the magic happens. It’s passed 3 arguments: <ul> <li><code class="highlighter-rouge">msg</code> <ul> <li><a target="_blank" href="https://discord.js.org/#/docs/main/stable/class/Message" title="Message • discord.js"><em>Message:</em></a> The Discord Message that triggered the function.</li> </ul> </li> <li><code class="highlighter-rouge">regexMatch</code> <ul> <li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/exec" title="RegExp.prototype.exec() - JavaScript | MDN"><em>Array (RegExp result):</em></a> The Regular Expression match. The result of calling the <code class="highlighter-rouge">exec</code> function on the RegExp.</li> </ul> </li> <li><code class="highlighter-rouge">Haruka</code> <ul> <li><a target="_blank" href="https://developer.mozilla.com/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" title="Object - JavaScript | MDN"><em>Object:</em></a> The Haruka object.</li> </ul> </li> </ul> </li> </ul> </li> <li><code class="highlighter-rouge">help</code> <ul> <li><a target="_blank" href="https://developer.mozilla.com/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" title="Object - JavaScript | MDN"><em>Object:</em></a> The function’s help descriptions. <ul> <li><code class="highlighter-rouge">short</code> <ul> <li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="String - JavaScript | MDN"><em>String:</em></a> The function’s short help description. This appears in the <code class="highlighter-rouge">-h help</code> command list.</li> </ul> </li> <li><code class="highlighter-rouge">long</code> <ul> <li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="String - JavaScript | MDN"><em>String:</em></a> The function’s long help description. This appears when calling <code class="highlighter-rouge">-h help &lt;name&gt;</code> It should be very descriptive, documenting the function’s usage and arguments.</li> </ul> </li> <li><code class="highlighter-rouge">hidden</code> <ul> <li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="Boolean - JavaScript | MDN"><em>Boolean:</em></a> When set to true, this function won’t appear in the <code class="highlighter-rouge">-h help</code> command list.</li> </ul> </li> </ul> </li> </ul> </li> </ul> <p>A Special has a much shorter format. Note that because there’s no RegExp, <code class="highlighter-rouge">handler</code> is called on every message. The handler’s return value determines whether the <code class="highlighter-rouge">Haruka.try</code> function ends early. The handler should return a truthy value if it handled the message, otherwise it should return something false-y.</p> <div class="language-coffee highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Special object</span>
<span class="nx">module</span><span class="p">.</span><span class="na">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">name</span><span class="o">:</span> <span class="s">"Special name"</span>
    <span class="na">handler</span><span class="o">:</span> <span class="p">(</span><span class="nx">msg</span><span class="p">,</span> <span class="nx">Haruka</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nx">msg</span><span class="p">.</span><span class="na">reply</span> <span class="s">"Hello world!"</span>
<span class="p">}</span>
</code></pre></div></div> <ul> <li><code class="highlighter-rouge">name</code> <ul> <li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="String - JavaScript | MDN"><em>String:</em></a> The name of the special. Pretty self explanatory.</li> </ul> </li> <li><code class="highlighter-rouge">handler</code> <ul> <li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" title="Function - JavaScript | MDN"><em>Function:</em></a> The special’s message handler. Here’s where all of the magic happens. It’s passed 2 arguments: <ul> <li><code class="highlighter-rouge">msg</code> <ul> <li><a target="_blank" href="https://discord.js.org/#/docs/main/stable/class/Message" title="Message • discord.js"><em>Message:</em></a> The Discord Message.</li> </ul> </li> <li><code class="highlighter-rouge">Haruka</code> <ul> <li><a target="_blank" href="https://developer.mozilla.com/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" title="Object - JavaScript | MDN"><em>Object:</em></a> The Haruka object.</li> </ul> </li> </ul> </li> </ul> </li> </ul> <hr/> <h2 id="the-haruka-object">The Haruka object</h2> <p>Every script has access to the Haruka object. Environment variables, scripts, and the Discord client are all attached to this object. The object looks like this:</p> <div class="language-coffee highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Haruka</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">client</span><span class="o">:</span> <span class="k">new</span> <span class="nx">Discord</span><span class="p">.</span><span class="na">Client</span>
    <span class="na">config</span><span class="o">:</span> <span class="nx">require</span> <span class="s">'../config.json'</span>
    <span class="na">dev</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="na">config</span><span class="p">.</span><span class="na">dev</span>
    <span class="na">functions</span><span class="o">:</span> <span class="p">[]</span>
    <span class="na">prefix</span><span class="o">:</span> <span class="k">if</span> <span class="k">this</span><span class="p">.</span><span class="na">dev</span> <span class="k">then</span> <span class="s">'#h'</span> <span class="k">else</span> <span class="s">'-h'</span>
    <span class="na">specials</span><span class="o">:</span> <span class="p">[]</span>
    <span class="na">try</span><span class="o">:</span> <span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="c1"># ...</span>
    <span class="na">version</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="na">config</span><span class="p">.</span><span class="na">version</span>
<span class="p">}</span>
</code></pre></div></div> <ul> <li><code class="highlighter-rouge">client</code> <ul> <li><a target="_blank" href="https://discord.js.org/#/docs/main/stable/class/Client" title="Client • discord.js"><em>Client:</em></a> The main hub for interacting with the Discord API, and the starting point for any bot.</li> </ul> </li> <li><code class="highlighter-rouge">config</code> <ul> <li><a target="_blank" href="https://developer.mozilla.com/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" title="Object - JavaScript | MDN"><em>Object:</em></a> The contents of <code class="highlighter-rouge">config.json</code>.</li> </ul> </li> <li><code class="highlighter-rouge">dev</code> <ul> <li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="Boolean - JavaScript | MDN"><em>Boolean:</em></a> Whether Haruka is in dev mode or not. This is the same as <code class="highlighter-rouge">Haruka.config.dev</code></li> </ul> </li> <li><code class="highlighter-rouge">functions</code> <ul> <li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" title="Array - JavaScript | MDN"><em>Array:</em></a> An array of Function objects. See <a href="#functions-and-specials">Functions and Specials</a>.</li> </ul> </li> <li><code class="highlighter-rouge">prefix</code> <ul> <li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="String - JavaScript | MDN"><em>String:</em></a> The Haruka prefix. <a href="https://github.com/MindfulMinun/discord-haruka/blob/master/src/main.coffee#L12" target="_blank" _="_">This is determined by the value of <code class="highlighter-rouge">Haruka.dev</code>.</a></li> </ul> </li> <li><code class="highlighter-rouge">specials</code> <ul> <li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" title="Array - JavaScript | MDN"><em>Array:</em></a> An array of Special objects. See <a href="#functions-and-specials">Functions and Specials</a>.</li> </ul> </li> <li><code class="highlighter-rouge">try</code> <ul> <li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" title="Function - JavaScript | MDN"><em>Function:</em></a> This function determines what function or special should be executed. See <a href="#executing-functions-and-specials">Executing functions and specials</a>.</li> </ul> </li> <li><code class="highlighter-rouge">version</code> <ul> <li><a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" title="String - JavaScript | MDN"><em>String:</em></a> Haruka’s current version. This is the same as <code class="highlighter-rouge">Haruka.config.version</code></li> </ul> </li> </ul> </article> </div> <aside class="container post-thread disqus-thread"> <hr> <div id="disqus_thread"></div> <script>!function(){var e=document,t=e.createElement("script");t.src="https://benji-xyz.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)}();</script> <noscript class="txt-center txt-i txt-aside"> <p> Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" target="_blank">comments powered by Disqus.</a> </p> </noscript> </aside> </main><footer class="footer" id="footer"> <div class="container"> <div class="grid"> <div class="m6 s12"> <h2 class="h4 txt-light flush" id="footer--about">About</h2> <p><p>I like coding things for the Internet &amp; playing the piano. I’m also on <a href="https://twitter.com/MindfulMinun">Twitter</a> and <a href="https://codepen.io/MindfulMinun">CodePen</a>. Feel free to say hi.</p> </p> </div> <div class="m6 s12"> <nav> <h2 class="h4 txt-light flush">Navigation</h2> <ul> <li><a href="/">Home</a></li> <li><a href="/p/">Projects</a></li> </ul> </nav> </div> </div> </div> <div class="mini-ribbon"> <div class="container"> <p id="footer--blob"> <noscript> “I heard hackers can use ‘java scripts’ to hack into your bank account” &mdash;&nbsp;Paranoid&nbsp;mom </noscript> </p> </div> </div> </footer> <div id="toast-container" aria-live="polite"></div></body> <script src="/scripts/post.js"></script><script src="/scripts/master.js"></script> <script>navigator.serviceWorker&&navigator.serviceWorker.register("/sw.js");</script> </html>